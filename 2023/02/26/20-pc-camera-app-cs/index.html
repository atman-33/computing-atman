<!DOCTYPE html>
<html style="display: none;" lang="ja">
    <head>
    <meta charset="utf-8">
    <!--
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.5.6 -->
    <script>
        window.materialVersion = "1.5.6"
        // Delete localstorage with these tags
        window.oldVersion = [
            'codestartv1',
            '1.3.4',
            '1.4.0',
            '1.4.0b1',
            '1.5.0',
            '1.5.2',
            '1.5.5'
        ]
    </script>

    <!-- dns prefetch -->
    <meta http-equiv="x-dns-prefetch-control" content="on">







    <link rel="dns-prefetch" href="https://www.google-analytics.com"/>



    <link rel="dns-prefetch" href="https://fonts.googleapis.com"/>





    <!-- Meta & Info -->
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!-- Title -->
    
    <title>
        
            【C#】PCカメラから映像を取得するアプリ | 
        
        Computing Atman
    </title>

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/favicon.png">
    <link rel="icon" href="/img/favicon.png">

    <meta name="format-detection" content="telephone=no"/>
    <meta name="description" itemprop="description" content="IT関連の情報を発信します。">
    <meta name="keywords" content=",C#,OpenCV">
    <meta name="theme-color" content="#0097A7">

    <!-- Disable Fucking Bloody Baidu Tranformation -->
    <meta http-equiv="Cache-Control" content="no-transform" />
    <meta http-equiv="Cache-Control" content="no-siteapp" />

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.en.js"></script>
        
    <![endif]-->

    <!-- Import lsloader -->
    <script>(function(){window.lsloader={jsRunSequence:[],jsnamemap:{},cssnamemap:{}};lsloader.removeLS=function(a){try{localStorage.removeItem(a)}catch(b){}};lsloader.setLS=function(a,c){try{localStorage.setItem(a,c)}catch(b){}};lsloader.getLS=function(a){var c="";try{c=localStorage.getItem(a)}catch(b){c=""}return c};versionString="/*"+(window.materialVersion||"unknownVersion")+"*/";lsloader.clean=function(){try{var b=[];for(var a=0;a<localStorage.length;a++){b.push(localStorage.key(a))}b.forEach(function(e){var f=lsloader.getLS(e);if(window.oldVersion){var d=window.oldVersion.reduce(function(g,h){return g||f.indexOf("/*"+h+"*/")!==-1},false);if(d){lsloader.removeLS(e)}}})}catch(c){}};lsloader.clean();lsloader.load=function(f,a,b,d){if(typeof b==="boolean"){d=b;b=undefined}d=d||false;b=b||function(){};var e;e=this.getLS(f);if(e&&e.indexOf(versionString)===-1){this.removeLS(f);this.requestResource(f,a,b,d);return}if(e){var c=e.split(versionString)[0];if(c!=a){console.log("reload:"+a);this.removeLS(f);this.requestResource(f,a,b,d);return}e=e.split(versionString)[1];if(d){this.jsRunSequence.push({name:f,code:e});this.runjs(a,f,e)}else{document.getElementById(f).appendChild(document.createTextNode(e));b()}}else{this.requestResource(f,a,b,d)}};lsloader.requestResource=function(b,e,a,c){var d=this;if(c){this.iojs(e,b,function(h,f,g){d.setLS(f,h+versionString+g);d.runjs(h,f,g)})}else{this.iocss(e,b,function(f){document.getElementById(b).appendChild(document.createTextNode(f));d.setLS(b,e+versionString+f)},a)}};lsloader.iojs=function(d,b,g){var a=this;a.jsRunSequence.push({name:b,code:""});try{var f=new XMLHttpRequest();f.open("get",d,true);f.onreadystatechange=function(){if(f.readyState==4){if((f.status>=200&&f.status<300)||f.status==304){if(f.response!=""){g(d,b,f.response);return}}a.jsfallback(d,b)}};f.send(null)}catch(c){a.jsfallback(d,b)}};lsloader.iocss=function(f,c,h,a){var b=this;try{var g=new XMLHttpRequest();g.open("get",f,true);g.onreadystatechange=function(){if(g.readyState==4){if((g.status>=200&&g.status<300)||g.status==304){if(g.response!=""){h(g.response);a();return}}b.cssfallback(f,c,a)}};g.send(null)}catch(d){b.cssfallback(f,c,a)}};lsloader.iofonts=function(f,c,h,a){var b=this;try{var g=new XMLHttpRequest();g.open("get",f,true);g.onreadystatechange=function(){if(g.readyState==4){if((g.status>=200&&g.status<300)||g.status==304){if(g.response!=""){h(g.response);a();return}}b.cssfallback(f,c,a)}};g.send(null)}catch(d){b.cssfallback(f,c,a)}};lsloader.runjs=function(f,c,e){if(!!c&&!!e){for(var b in this.jsRunSequence){if(this.jsRunSequence[b].name==c){this.jsRunSequence[b].code=e}}}if(!!this.jsRunSequence[0]&&!!this.jsRunSequence[0].code&&this.jsRunSequence[0].status!="failed"){var a=document.createElement("script");a.appendChild(document.createTextNode(this.jsRunSequence[0].code));a.type="text/javascript";document.getElementsByTagName("head")[0].appendChild(a);this.jsRunSequence.shift();if(this.jsRunSequence.length>0){this.runjs()}}else{if(!!this.jsRunSequence[0]&&this.jsRunSequence[0].status=="failed"){var d=this;var a=document.createElement("script");a.src=this.jsRunSequence[0].path;a.type="text/javascript";this.jsRunSequence[0].status="loading";a.onload=function(){d.jsRunSequence.shift();if(d.jsRunSequence.length>0){d.runjs()}};document.body.appendChild(a)}}};lsloader.tagLoad=function(b,a){this.jsRunSequence.push({name:a,code:"",path:b,status:"failed"});this.runjs()};lsloader.jsfallback=function(c,b){if(!!this.jsnamemap[b]){return}else{this.jsnamemap[b]=b}for(var a in this.jsRunSequence){if(this.jsRunSequence[a].name==b){this.jsRunSequence[a].code="";this.jsRunSequence[a].status="failed";this.jsRunSequence[a].path=c}}this.runjs()};lsloader.cssfallback=function(e,c,b){if(!!this.cssnamemap[c]){return}else{this.cssnamemap[c]=1}var d=document.createElement("link");d.type="text/css";d.href=e;d.rel="stylesheet";d.onload=d.onerror=b;var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(d,a)};lsloader.runInlineScript=function(c,b){var a=document.getElementById(b).innerText;this.jsRunSequence.push({name:c,code:a});this.runjs()}})();</script>

    <!-- Import queue -->
    <script>function Queue(){this.dataStore=[];this.offer=b;this.poll=d;this.execNext=a;this.debug=false;this.startDebug=c;function b(e){if(this.debug){console.log("Offered a Queued Function.")}if(typeof e==="function"){this.dataStore.push(e)}else{console.log("You must offer a function.")}}function d(){if(this.debug){console.log("Polled a Queued Function.")}return this.dataStore.shift()}function a(){var e=this.poll();if(e!==undefined){if(this.debug){console.log("Run a Queued Function.")}e()}}function c(){this.debug=true}}var queue=new Queue();</script>

    <!-- Import CSS -->
    
        <style id="material_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_css","/css/material.min.css?Z7a72R1E4SxzBKR/WGctOA==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
        <style id="style_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("style_css","/css/style.min.css?FHxWBjH/JMTBvh8NmS/dNg==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>

        

    

    

    <!-- Config CSS -->

<!-- Other Styles -->
<style>
  body, html {
    font-family: Arial, sans-serif;
    overflow-x: hidden !important;
  }
  
  code {
    font-family: 'Meiryo UI', メイリオ, Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  a {
    color: #00838F;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #0097A7 !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #0097A7 !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #0097A7 !important;
  }

  .toTop {
    background: #757575 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #757575;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #757575;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #757575;
  }

  .post-toc a:hover {
    color: #00838F;
    text-decoration: underline;
  }

</style>


<!-- Theme Background Related-->

    <style>
      body{
        background-color: #F5F5F5;
      }

      /* blog_info bottom background */
      #scheme-Paradox .material-layout .something-else .mdl-card__supporting-text{
        background-color: #fff;
      }
    </style>




<!-- Fade Effect -->

    <style>
      .fade {
        transition: all 800ms linear;
        -webkit-transform: translate3d(0,0,0);
        -moz-transform: translate3d(0,0,0);
        -ms-transform: translate3d(0,0,0);
        -o-transform: translate3d(0,0,0);
        transform: translate3d(0,0,0);
        opacity: 1;
      }

      .fade.out{
        opacity: 0;
      }
    </style>


<!-- Import Font -->
<!-- Import Roboto -->

    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet">


<!-- Import Material Icons -->


    <style id="material_icons"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_icons","/css/material-icons.css?pqhB/Rd/ab0H2+kZp0RDmw==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>




    <!-- Import jQuery -->
    
        <script>lsloader.load("jq_js","/js/jquery.min.js?ezyEvm8ST5CGfpA+kFFi1g==", true)</script>
    

    <!-- WebAPP Icons -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="Computing Atman">
    <meta name="msapplication-starturl" content="https://www.computing-atman.com/2023/02/26/20-pc-camera-app-cs/">
    <meta name="msapplication-navbutton-color" content="#0097A7">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="Computing Atman">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon" href="/img/favicon.png">

    <!-- Site Verification -->
    
    

    <!-- RSS -->
    

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="https://www.computing-atman.com/2023/02/26/20-pc-camera-app-cs/">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="【C#】PCカメラから映像を取得するアプリ | Computing Atman">
    <meta property="og:image" content="/img/favicon.png">
    <meta property="og:description" content="IT関連の情報を発信します。">
    <meta property="og:article:tag" content="C#"> <meta property="og:article:tag" content="OpenCV"> 

    
        <meta property="article:published_time" content="Sun Feb 26 2023 18:29:30 GMT+0900">
        <meta property="article:modified_time" content="Sun Mar 05 2023 21:38:42 GMT+0900">
    

    <!-- The Twitter Card protocol -->
    <meta name="twitter:card" content="summary_large_image">

    <!-- Add canonical link for SEO -->
    
        <link rel="canonical" href="https://www.computing-atman.com/2023/02/26/20-pc-camera-app-cs/index.html" />
    

    <!-- Structured-data for SEO -->
    
        


<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "mainEntityOfPage": "https://www.computing-atman.com/2023/02/26/20-pc-camera-app-cs/index.html",
    "headline": "【C#】PCカメラから映像を取得するアプリ",
    "datePublished": "Sun Feb 26 2023 18:29:30 GMT+0900",
    "dateModified": "Sun Mar 05 2023 21:38:42 GMT+0900",
    "author": {
        "@type": "Person",
        "name": "Atman",
        "image": {
            "@type": "ImageObject",
            "url": "/img/avatar.png"
        },
        "description": "IT、プログラミング情報サイト"
    },
    "publisher": {
        "@type": "Organization",
        "name": "Computing Atman",
        "logo": {
            "@type":"ImageObject",
            "url": "/img/favicon.png"
        }
    },
    "keywords": ",C#,OpenCV",
    "description": "IT関連の情報を発信します。"
}
</script>


    

    <!-- Analytics -->
    
        <!-- 下記のデフォルトスクリプトは利用せず、直接タグを記載する事とした。by Atman
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
    ga('create', 'G-1W91JVY5LN', 'auto');ga('send', 'pageview');
</script>
-->

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-1W91JVY5LN"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-1W91JVY5LN');
</script>

<!-- Google AdSense Code -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3632222360837456"
     crossorigin="anonymous"></script>

    
    
    

    <!-- Custom Head -->
    

<meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="Computing Atman" type="application/atom+xml">
</head>


    
        <body id="scheme-Paradox" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span id="MD-burger-id" class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->


    <!-- Left aligned menu below button -->
    
    
    <button id="post-toc-trigger-btn"
        class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn" style="max-height:80vh; overflow-y:scroll;">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link"><span class="post-toc-number">1.</span> <span class="post-toc-text">概要</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link"><span class="post-toc-number">2.</span> <span class="post-toc-text">パッケージ構成</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link"><span class="post-toc-number">3.</span> <span class="post-toc-text">製作手順</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">①プロジェクトの作成</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link"><span class="post-toc-number">3.2.</span> <span class="post-toc-text">②OpenCVSharpインストール</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link"><span class="post-toc-number">3.3.</span> <span class="post-toc-text">③AForge.NETダウンロード</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link"><span class="post-toc-number">3.4.</span> <span class="post-toc-text">④AForge.NET モジュール参照設定</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link"><span class="post-toc-number">3.5.</span> <span class="post-toc-text">⑤アプリケーションのデザイン製作</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link"><span class="post-toc-number">3.6.</span> <span class="post-toc-text">⑥ソースコードの埋め込み</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link"><span class="post-toc-number">3.7.</span> <span class="post-toc-text">⑦顔認識の方法</span></a></li></ol></li></ol>
    </ul>
    




<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        
            <!-- Random Thumbnail -->
            <div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
            <script type="text/ls-javascript" id="post-thumbnail-script">
    var randomNum = Math.floor(Math.random() * 19 + 1);

    $('.post_thumbnail-random').attr('data-original', '/img/random/material-' + randomNum + '.png');
    $('.post_thumbnail-random').addClass('lazy');
</script>

        
    
            <p class="article-headline-p">
                【C#】PCカメラから映像を取得するアプリ
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/avatar.png" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>Atman</strong>
        <span>2月 26, 2023</span>
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    

    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-none-link" href="/tags/C/" rel="tag">C#</a></li><li class="mdl-menu__item"><a class="post_tag-none-link" href="/tags/OpenCV/" rel="tag">OpenCV</a>
    </ul>
    

    <!-- Share -->
    
        <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    

    

    <!-- Share Weibo -->
    

    <!-- Share Twitter -->
    
        <a class="post_share-link" href="https://twitter.com/intent/tweet?text=【C#】PCカメラから映像を取得するアプリ&url=https://www.computing-atman.com/2023/02/26/20-pc-camera-app-cs/index.html&via=Atman" target="_blank">
            <li class="mdl-menu__item">
                Twitter での共有
            </li>
        </a>
    

    <!-- Share Facebook -->
    
        <a class="post_share-link" href="https://www.facebook.com/sharer/sharer.php?u=https://www.computing-atman.com/2023/02/26/20-pc-camera-app-cs/index.html" target="_blank">
            <li class="mdl-menu__item">
                Facebook での共有
            </li>
        </a>
    

    <!-- Share Google+ -->
    
        <a class="post_share-link" href="https://plus.google.com/share?url=https://www.computing-atman.com/2023/02/26/20-pc-camera-app-cs/index.html" target="_blank">
            <li class="mdl-menu__item">
                Google+ での共有
            </li>
        </a>
    

    <!-- Share LinkedIn -->
    

    <!-- Share QQ -->
    

    <!-- Share Telegram -->
    
</ul>

    
</div>

                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <p>PCに搭載されているカメラの映像を取得して、解析等を行いたいと思ったことはないでしょうか？</p>
<p>今回、PCカメラの映像を加工して表示させるアプリケーションを作成しましたので紹介します。</p>
<p><a target="_blank" rel="noopener" href="https://github.com/atman-33/pc-camera-app-cs">【ソースコードはこちら】</a></p>
<p><strong>2020&#x2F;4&#x2F;14追記</strong><br>ソースコードをダウンロードして、Visual Studio からソリューションファイルを開くと参照部分にエラーが発生する場合があります。<br>下記リンク先の方法で対処できますので参考にしてください。</p>
<hr>
<p>目次</p>
<!-- toc -->

<ul>
<li><a href="#%E6%A6%82%E8%A6%81">概要</a></li>
<li><a href="#%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8%E6%A7%8B%E6%88%90">パッケージ構成</a></li>
<li><a href="#%E8%A3%BD%E4%BD%9C%E6%89%8B%E9%A0%86">製作手順</a><ul>
<li><a href="#1%E3%83%97%E3%83%AD%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AE%E4%BD%9C%E6%88%90">①プロジェクトの作成</a></li>
<li><a href="#2opencvsharp%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB">②OpenCVSharpインストール</a></li>
<li><a href="#3aforgenet%E3%83%80%E3%82%A6%E3%83%B3%E3%83%AD%E3%83%BC%E3%83%89">③AForge.NETダウンロード</a></li>
<li><a href="#4aforgenet-%E3%83%A2%E3%82%B8%E3%83%A5%E3%83%BC%E3%83%AB%E5%8F%82%E7%85%A7%E8%A8%AD%E5%AE%9A">④AForge.NET モジュール参照設定</a></li>
<li><a href="#5%E3%82%A2%E3%83%97%E3%83%AA%E3%82%B1%E3%83%BC%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%AE%E3%83%87%E3%82%B6%E3%82%A4%E3%83%B3%E8%A3%BD%E4%BD%9C">⑤アプリケーションのデザイン製作</a></li>
<li><a href="#6%E3%82%BD%E3%83%BC%E3%82%B9%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AE%E5%9F%8B%E3%82%81%E8%BE%BC%E3%81%BF">⑥ソースコードの埋め込み</a></li>
<li><a href="#7%E9%A1%94%E8%AA%8D%E8%AD%98%E3%81%AE%E6%96%B9%E6%B3%95">⑦顔認識の方法</a></li>
</ul>
</li>
</ul>
<!-- tocstop -->

<hr>
<hr>
<h2><span id="概要">概要</span></h2><p>PCに内蔵されているカメラと画像処理モードを選択することで、対応した映像をアプリケーションに表示します。</p>
<p>【画像処理モード】</p>
<ul>
<li>なし</li>
<li>グレー　：　映像がグレーになります。</li>
<li>顔認識　：　顔を認識した部分に赤の矩形を表示します。</li>
</ul>
<img src="/2023/02/26/20-pc-camera-app-cs/app_sample.png" class>

<hr>
<h2><span id="パッケージ構成">パッケージ構成</span></h2><p>今回のアプリケーションはVisual Studioで作成しています。プロジェクトフォルダ内には多くのファイルが含まれておりますので、主なファイルのみ説明します。</p>
<p>こちらは、上でダウンロード可能なソースコードと対応しています。</p>
<pre><code>PcCameraApp
|-MainForm.cs
|-OpenCVSharpBitmap.cs
|-haarcascade_frontalface_default.xml
</code></pre>
<table>
<thead>
<tr>
<th align="left">ファイル名</th>
<th align="left">機能</th>
</tr>
</thead>
<tbody><tr>
<td align="left">MainForm.cs</td>
<td align="left">アプリの操作に対する各種処理</td>
</tr>
<tr>
<td align="left">OpenCVSharpBitmap.cs</td>
<td align="left">映像を加工してBitmapで返すクラス</td>
</tr>
<tr>
<td align="left">haarcascade_frontalface_default.xml</td>
<td align="left">顔を検出するカスケードファイル</td>
</tr>
</tbody></table>
<hr>
<h2><span id="製作手順">製作手順</span></h2><p>Visual Studio を用いたアプリケーションの製作手順について説明していきます。</p>
<hr>
<h3><span id="1プロジェクトの作成">①プロジェクトの作成</span></h3><p>プロジェクトの作成に関して、詳細の説明は省略させて頂きます。</p>
<p>下記リンクを参考にしてプロジェクト作成まで進めてください。</p>
<p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/ja-jp/visualstudio/ide/create-new-project?view=vs-2019">Visual Studio での新しいプロジェクトの作成</a></p>
<hr>
<h3><span id="2opencvsharpインストール">②OpenCVSharpインストール</span></h3><p>画像処理の機能を扱えるように OpenCVSharp を使用できるようにします。</p>
<p>「プロジェクト」→「NuGet パッケージの管理」を開きます。</p>
<img src="/2023/02/26/20-pc-camera-app-cs/visual_studio_1.png" class>

<p>参照をクリックし、「opencv」を入力します。</p>
<p>表示された一覧から、「OpenCvSharp3-AnyCPU」を選択してインストールします。</p>
<img src="/2023/02/26/20-pc-camera-app-cs/11.png" class>

<hr>
<h3><span id="3aforgenetダウンロード">③AForge.NETダウンロード</span></h3><p>PC付随のカメラを利用する際には、AForge.NETという外部ライブラリで一通りの処理がまかなえます。</p>
<p>ここで、カメラの映像取得用ライブラリを準備します。</p>
<p><a target="_blank" rel="noopener" href="http://www.aforgenet.com/framework/downloads.html">AFroge.netの配布サイト</a></p>
<p>「Download Libraries Only 」を選択しダウンロードを行います。</p>
<img src="/2023/02/26/20-pc-camera-app-cs/aforge_net.png" class>

<hr>
<h3><span id="4aforgenet-モジュール参照設定">④AForge.NET モジュール参照設定</span></h3><p>ダウンロードしたフォルダ（AForge.NET Framework-2.2.5-(libs only).zip）の中に「Relese」というフォルダがあります。</p>
<p>この「Relese」フォルダから、今回必要な下記の２点のファイルをVisual Studioの参照設定に追加します。</p>
<ul>
<li>AForge.Video.dll</li>
<li>AForge.Video.DirecrtShow.dll</li>
</ul>
<img src="/2023/02/26/20-pc-camera-app-cs/visual_studio_1.png" class>
<img src="/2023/02/26/20-pc-camera-app-cs/visual_studio_2.png" class>

<hr>
<h3><span id="5アプリケーションのデザイン製作">⑤アプリケーションのデザイン製作</span></h3><p>今回のアプリケーションはシンプルです。</p>
<p>フォームアプリケーションのデザイン側で、ツールボックスより、必要な数のComboBox、Button、Label、PictureBox、Timerを配置します。</p>
<p>ここで、PictureBox はカメラ映像を映す部分ですが、映像が大きい場合は、準備した PictureBox 内に映像が収まりません。</p>
<p>そのため、PictureBox の SizeMode を StreachImage に変更しておきましょう。</p>
<img src="/2023/02/26/20-pc-camera-app-cs/visual_studio_3.png" class>

<hr>
<h3><span id="6ソースコードの埋め込み">⑥ソースコードの埋め込み</span></h3><p>ここからはソースコードについてです。まずは、フォームのコード側です。</p>
<p>▼ MainForm.cs</p>
<pre><code>using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Diagnostics;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;

using AForge.Video;             // AForge.NETライブラリから読込
using AForge.Video.DirectShow;  // AForge.NETライブラリから読込

using Original;

namespace PcCameraApp
&#123;
    public partial class MainForm : Form
    &#123;
        // フィールド
        readonly string[] IMAGE_MODE = &#123; &quot;なし&quot;, &quot;グレー&quot;, &quot;顔認識&quot; &#125;;  // 画像処理モード
        private string mode;                                            // 現在の画像処理モード

        public bool DeviceExist = false;                // デバイス有無
        public FilterInfoCollection videoDevices;       // カメラデバイスの一覧
        public VideoCaptureDevice videoSource = null;   // カメラデバイスから取得した映像

        public MainForm()
        &#123;
            InitializeComponent();
        &#125;

        // Loadイベント（Formの立ち上げ時に実行）
        private void Form1_Load(object sender, EventArgs e)
        &#123;
            Debug.WriteLine(&quot;Formのロード開始&quot;);
            this.getCameraInfo();
        &#125;

        // カメラ情報の取得
        public void getCameraInfo()
        &#123;
            try
            &#123;
                // 端末で認識しているカメラデバイスの一覧を取得
                videoDevices = new FilterInfoCollection(FilterCategory.VideoInputDevice);
                comboBoxCameraType.Items.Clear();

                if (videoDevices.Count == 0)
                    throw new ApplicationException();

                foreach (FilterInfo device in videoDevices)
                &#123;
                    // カメラデバイスの一覧をコンボボックスに追加
                    comboBoxCameraType.Items.Add(device.Name);
                    comboBoxCameraType.SelectedIndex = 0;
                    DeviceExist = true;
                &#125;
            &#125;
            catch (ApplicationException)
            &#123;
                DeviceExist = false;
                comboBoxCameraType.Items.Add(&quot;Deviceが存在していません。&quot;);
            &#125;

            comboBoxMode.Items.Clear();

            // 画像処理モードの追加
            foreach (string mode in IMAGE_MODE)
            &#123;
                comboBoxMode.Items.Add(mode);
            &#125;
        &#125;

        // 開始or停止ボタン
        private void button1_Click(object sender, EventArgs e)
        &#123;
            Debug.WriteLine(&quot;ボタンクリック&quot;);
            mode = comboBoxMode.Text;

            if (buttonStartStop.Text == &quot;開始&quot;)
            &#123;

                if (DeviceExist)
                &#123;
                    videoSource = new VideoCaptureDevice(videoDevices[comboBoxCameraType.SelectedIndex].MonikerString);
                    videoSource.NewFrame += new NewFrameEventHandler(videoRendering);
                    this.CloseVideoSource();

                    videoSource.Start();

                    buttonStartStop.Text = &quot;停止&quot;;
                    timer1.Enabled = true;

                    Debug.WriteLine(&quot;画像処理モード：&quot; + mode);
                &#125;
                else
                &#123;
                    labelFps.Text = &quot;デバイスが存在していません。&quot;;
                &#125;
            &#125;
            else
            &#123;
                if (videoSource.IsRunning)
                &#123;
                    timer1.Enabled = false;
                    this.CloseVideoSource();
                    labelFps.Text = &quot;停止中&quot;;
                    buttonStartStop.Text = &quot;開始&quot;;

                &#125;
            &#125;
        &#125;
        // 描画処理
        private void videoRendering(object sender, NewFrameEventArgs eventArgs)
        &#123;
            Bitmap img = (Bitmap)eventArgs.Frame.Clone();

            Debug.WriteLine(DateTime.Now + &quot;:&quot; + &quot;描画更新&quot;);
            // Debug.WriteLine(mode);

            try
            &#123;
                switch (mode)
                &#123;
                    case &quot;なし&quot;:
                        pictureBoxCamera.Image = img;
                        break;

                    case &quot;グレー&quot;:
                        using (OpenCVSharpBitmap bitmap = new OpenCVSharpBitmap(img))
                        &#123;
                            pictureBoxCamera.Image = bitmap.toGray();
                        &#125;
                        break;

                    case &quot;顔認識&quot;:
                        using (OpenCVSharpBitmap bitmap = new OpenCVSharpBitmap(img))
                        &#123;
                            string strCurDir = System.Environment.CurrentDirectory;
                            Debug.WriteLine(strCurDir);
                            // pictureBoxCamera.Image = bitmap.addFaceRect(@&quot;C:\Users\gpbjk\source\repos\Original\cs\opencv\haarcascade_frontalface_default.xml&quot;);
                            pictureBoxCamera.Image = bitmap.addFaceRect(strCurDir + @&quot;\haarcascade_frontalface_default.xml&quot;);
                        &#125;
                        break;

                    default:
                        pictureBoxCamera.Image = img;
                        break;
                &#125;
            &#125;
            catch
            &#123;
                pictureBoxCamera.Image = img;
            &#125;
        &#125;
        // 停止の初期化
        private void CloseVideoSource()
        &#123;
            if (!(videoSource == null))
                if (videoSource.IsRunning)
                &#123;
                    videoSource.SignalToStop();
                    videoSource = null;
                &#125;
        &#125;
        // フレームレートの取得
        private void timer1_Tick(object sender, EventArgs e)
        &#123;
            labelFps.Text = videoSource.FramesReceived.ToString() + &quot;FPS&quot;;
        &#125;
        // ソフト終了時のクローズ処理
        private void MainForm_FormClosing(object sender, FormClosingEventArgs e)
        &#123;
            if (videoSource != null)
            &#123;
                // Form を閉じる際は映像データ取得をクローズ
                if (videoSource.IsRunning)
                &#123;
                    this.CloseVideoSource();
                &#125;
            &#125;
        &#125;
    &#125;
&#125;
</code></pre>
<p>描画処理部分で、クラス「OpenCVSharpBitmap 」を使っています。</p>
<p>このクラスで、映像を加工してBitmapのデータを返す処理を行います。</p>
<p>▼OpenCVSharpBitmap .cs</p>
<pre><code>using OpenCvSharp;
using OpenCvSharp.Extensions;
using System;
using System.Drawing;

///

/// オリジナルクラス
///

namespace Original
&#123;
    public class OpenCVSharpBitmap : IDisposable
    &#123;
        private Mat mat;

        ///

        /// コンストラクタ
        ///

        ///
        public OpenCVSharpBitmap(Bitmap img)
        &#123;
            this.mat = BitmapConverter.ToMat(img);
        &#125;

        public void Dispose()
        &#123;
            ((IDisposable)mat).Dispose();
        &#125;

        ///

        /// グレーに変換したBitmapを取得
        ///

        ///
        public Bitmap toGray()
        &#123;
            Mat matGray = mat.CvtColor(ColorConversionCodes.BGR2GRAY);
            return BitmapConverter.ToBitmap(matGray);
        &#125;

        ///

        /// 顔を認識して赤枠を追加したBitmapを取得
        ///

        ///
        ///
        public Bitmap addFaceRect(string @cascadePath)
        &#123;
            // 分類機の用意
            using (CascadeClassifier cascade = new CascadeClassifier(@cascadePath))
            &#123;
                foreach (Rect rectFace in cascade.DetectMultiScale(mat))
                &#123;
                    // 見つかった場所に赤枠を表示
                    Rect rect = new Rect(rectFace.X, rectFace.Y, rectFace.Width, rectFace.Height);
                    mat.Rectangle(rect, new OpenCvSharp.Scalar(0,0,255), 3, LineTypes.Link8);
                &#125;
            &#125;

            return BitmapConverter.ToBitmap(mat);
        &#125;
    &#125;
&#125;
</code></pre>
<hr>
<h3><span id="7顔認識の方法">⑦顔認識の方法</span></h3><p>顔認識した矩形を映像に加える処理は、補足で説明しておきます。</p>
<p>まず、今回の顔認識では <strong>「カスケード分類」</strong> と呼ばれる方法を用いています。予め、特定のモノを区別する設定値が含まれるXMLファイル（カスケードファイル）をダウンロードしておき、そのファイルを OpenCvSharp の関数から読み込みます。</p>
<p>顔認識に必要なXMLファイル「haarcascade_frontalface_default.xml」は、下記のgithubからダウンロードできます。</p>
<p><a target="_blank" rel="noopener" href="https://github.com/opencv/opencv/blob/master/data/haarcascades/haarcascade_frontalface_default.xml">https://github.com/opencv/opencv/blob/master/data/haarcascades/haarcascade_frontalface_default.xml</a></p>
<p>今回のアプリケーションでは、カスケードファイルを同プロジェクトの実行フォルダに保存して扱うようにしています。</p>
<p>MainForm.cs</p>
<pre><code>pictureBoxCamera.Image = bitmap.addFaceRect(strCurDir + @&quot;\haarcascade_frontalface_default.xml&quot;);
</code></pre>
<p>OpenCVSharpBitmap.cs</p>
<pre><code>using (CascadeClassifier cascade = new CascadeClassifier(@cascadePath))
</code></pre>
<p>このように、カスケードファイルは実行ファイルと同じフォルダのファイルを参照しますので、ビルドする際にはカスケードファイルを一緒に出力させる必要があります。</p>
<img src="/2023/02/26/20-pc-camera-app-cs/visual_studio_4.png" class>

<p>これで説明は終了です。</p>
<p>今回はあくまでシンプルなアプリケーションです。</p>
<p>画像処理の実装方法などは流用できますので、自分好みのアプリケーションを開発していく参考になれば幸いです。</p>
<p>以上です。</p>

        
    

    
</div>


                

                <!-- Post Comments -->
                
                    
                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    
        <a href="/2023/02/26/21-excel1-config-sheet-excel-vba/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Newer
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/2023/02/26/19-git-push-sample/" id="post_nav-older" class="next-content">
            Older
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/avatar.png" alt="Atman's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="https://twitter.com/atman_33" target="_blank" title="Tweet Me">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        
                        Tweet Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/">
                
                    <i class="material-icons sidebar-material-icons">home</i>
                
                ホーム
            </a>
        </li>
        
    

    <!-- Archives  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                    過去の投稿
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
            <li>
                <a class="sidebar_archives-link" href="/archives/2023/03/">3月 2023<span class="sidebar_archives-count">6</span></a></li><li><a class="sidebar_archives-link" href="/archives/2023/02/">2月 2023<span class="sidebar_archives-count">28</span></a>
            </ul>
        </li>
        
    

    <!-- Categories  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">chrome_reader_mode</i>
                
                カテゴリー
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
                <li>
                <a class="sidebar_archives-link" href="/categories/AWS/">AWS<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/C/">C#<span class="sidebar_archives-count">7</span></a></li><li><a class="sidebar_archives-link" href="/categories/Git/">Git<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/Hexo/">Hexo<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/categories/JavaScript/">JavaScript<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/categories/MQL/">MQL<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/Oracle/">Oracle<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/categories/PowerQuery/">PowerQuery<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/categories/Python/">Python<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/categories/VBA/">VBA<span class="sidebar_archives-count">7</span></a></li><li><a class="sidebar_archives-link" href="/categories/VBS/">VBS<span class="sidebar_archives-count">5</span></a></li><li><a class="sidebar_archives-link" href="/categories/WordPress/">WordPress<span class="sidebar_archives-count">3</span></a>
            </ul>
        </li>
        
            <li class="divider"></li>
        
    

    <!-- Pages  -->
    
        <li>
            <a href="/tags" title="タグ">
                
                    <i class="material-icons sidebar-material-icons">cloud_circle</i>
                
                タグ
            </a>
        </li>
        
    
        <li>
            <a href="/links" title="リンク">
                
                    <i class="material-icons sidebar-material-icons">face</i>
                
                リンク
            </a>
        </li>
        
    
        <li>
            <a href="/about" title="問い合わせ">
                
                    <i class="material-icons sidebar-material-icons">help</i>
                
                問い合わせ
            </a>
        </li>
        
    

    <!-- Article Number  -->
    
</ul>


        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Sidebar Divider -->

    <div class="sidebar-divider"></div>


<!-- Theme Material -->

    <a href="https://github.com/viosey/hexo-theme-material"  class="sidebar-footer-text-a" target="_blank">
        <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
            テーマ - Material
            <span class="sidebar-badge badge-circle">i</span>
        </div>
    </a>


<!-- Help & Support -->
<!--

-->

<!-- Feedback -->
<!--

-->

<!-- About Theme -->
<!--

-->

    </div>

    <!-- Sidebar Image -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div id="back-to-top" class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    
        <a href="https://twitter.com/twitter" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-twitter">
                <span class="visuallyhidden">Twitter</span>
            </button><!--
     --></a>
    

    <!-- Facebook -->
    
        <a href="https://www.facebook.com/facebook" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-facebook">
                <span class="visuallyhidden">Facebook</span>
            </button><!--
     --></a>
    

    <!-- Google + -->
    
        <a href="https://www.google.com/" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-gplus">
                <span class="visuallyhidden">Google Plus</span>
            </button><!--
     --></a>
    

    <!-- Weibo -->
    

    <!-- Instagram -->
    

    <!-- Tumblr -->
    

    <!-- Github -->
    

    <!-- LinkedIn -->
    

    <!-- Zhihu -->
    

    <!-- Bilibili -->
    

    <!-- Telegram -->
    

    <!-- V2EX -->
    

    <!-- Segmentfault -->
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©&nbsp;<span year></span>&nbsp;Computing Atman
            
        </div>

        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

        <div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
                <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
            </div>
        </div>
    
</footer>


                    <!-- Import JS File -->

    <script>lsloader.load("lazyload_js","/js/lazyload.min.js?wgjW/HuQG9JDgvPDPoRAng==", true)</script>



    <script>lsloader.load("js_js","/js/js.min.js?LT4t6iE6m8TO1BLGGiNJqA==", true)</script>



    <script>lsloader.load("np_js","/js/nprogress.js?pl3Qhb9lvqR1FlyLUna1Yw==", true)</script>


<script type="text/ls-javascript" id="NProgress-script">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#29d'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #29d, 0 0 15px #29d'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#29d',
        'border-left-color': '#29d'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>













<!-- UC Browser Compatible -->
<script>
	var agent = navigator.userAgent.toLowerCase();
	if(agent.indexOf('ucbrowser')>0) {
		document.write('
<link rel="stylesheet" href="/css/uc.css">
');
	   alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
	}
</script>

<!-- Import prettify js  -->


    
        <script>lsloader.load("hanabi","/js/hanabi-browser-bundle.js?3KhbRjbomJu68PRmIWfslQ==", true)</script>
    


<!-- Window Load -->
<!-- add class for prettify -->
<script type="text/ls-javascript" id="window-load">
    $(window).on('load', function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });

    
    
        
        
        HanabiBrowser.start('pre code',false);
    
</script>

<!-- MathJax Load-->


<!-- Bing Background -->


<script type="text/ls-javascript" id="lazy-load">
    // Offer LazyLoad
    queue.offer(function(){
        $('.lazy').lazyload({
            effect : 'show'
        });
    });

    // Start Queue
    $(document).ready(function(){
        setInterval(function(){
            queue.execNext();
        },200);
    });
</script>

<!-- Custom Footer -->



<script>
    var copyrightNow = new Date().getFullYear();
    var textContent = document.querySelector('span[year]')

    copyrightSince = 2023;
    if (copyrightSince === copyrightNow||copyrightSince === 0000) {
        textContent.textContent = copyrightNow
    } else {
        textContent.textContent = copyrightSince + ' - ' + copyrightNow
    }

    (function(){
        var scriptList = document.querySelectorAll('script[type="text/ls-javascript"]')

        for (var i = 0; i < scriptList.length; ++i) {
            var item = scriptList[i];
            lsloader.runInlineScript(item.id,item.id);
        }
    })()
console.log('\n %c © Material Theme | Version: 1.5.6 | https://github.com/viosey/hexo-theme-material %c \n', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-left-radius:5px;border-bottom-left-radius:5px;', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-right-radius:5px;border-bottom-right-radius:5px;');
</script>

                </main>
            </div>
        </body>
    
</html>
